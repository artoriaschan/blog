---
title: JavaScript è®¾è®¡æ¨¡å¼æ ¸å¿ƒåŸç†
subtitle: è¯»ã€ŠJavaScript è®¾è®¡æ¨¡å¼æ ¸â¼¼åŸç†ä¸åº”â½¤å®è·µã€‹æ€»ç»“
date: 2021-01-18 00:00:00
permalink: /pages/9fd655/
sidebar: auto
categories: 
  - åŸºç¡€çŸ¥è¯†
tags: 
  - Design Patterns
---
## å‰è¨€
èƒ½å¤Ÿå†³å®šä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆçš„æœ¬è´¨çš„ï¼Œä¸æ˜¯é‚£äº›ç¬æ¯ä¸‡å˜çš„æŠ€æœ¯ç‚¹ï¼Œè€Œæ˜¯é‚£äº›**ä¸å˜çš„ä¸œè¥¿**ã€‚

æ‰€è°“â€œä¸å˜çš„ä¸œè¥¿â€ï¼Œè¯´çš„å°±æ˜¯è¿™ç§**é©¾é©­æŠ€æœ¯çš„èƒ½åŠ›**ã€‚

å…·ä½“æ¥è¯´ï¼Œå®ƒåˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªå±‚æ¬¡ï¼š
* èƒ½ç”¨å¥å£®çš„ä»£ç å»è§£å†³å…·ä½“çš„é—®é¢˜ï¼›
* èƒ½ç”¨æŠ½è±¡çš„æ€ç»´å»åº”å¯¹å¤æ‚çš„ç³»ç»Ÿï¼›
* èƒ½ç”¨å·¥ç¨‹åŒ–çš„æ€æƒ³å»è§„åˆ’æ›´å¤§è§„æ¨¡çš„ä¸šåŠ¡ã€‚

æ•´æœ¬å°å†Œçš„çŸ¥è¯†ä½“ç³»ä¸æ ¼å±€ï¼Œç”¨æ€ç»´å¯¼å›¾å±•ç¤ºå¦‚ä¸‹ï¼š
![abstract](~@assets/posts/javascript-design-patterns/abstract.png)

è®¾è®¡åŸåˆ™æ˜¯è®¾è®¡æ¨¡å¼çš„æŒ‡å¯¼ç†è®ºï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§„é¿ä¸è‰¯çš„è½¯ä»¶è®¾è®¡ã€‚ **SOLID** æŒ‡ä»£çš„äº”ä¸ªåŸºæœ¬åŸåˆ™åˆ†åˆ«æ˜¯ï¼š
* **å•ä¸€åŠŸèƒ½åŸåˆ™** ï¼ˆSingle Responsibility Principleï¼‰
* **å¼€æ”¾å°é—­åŸåˆ™** ï¼ˆOpened Closed Principleï¼‰
* **é‡Œå¼æ›¿æ¢åŸåˆ™** ï¼ˆLiskov Substitution Principleï¼‰
* **æ¥å£éš”ç¦»åŸåˆ™** ï¼ˆInterface Segregation Principleï¼‰
* **ä¾èµ–åè½¬åŸåˆ™** ï¼ˆDependency Inversion Principleï¼‰

åœ¨ JavaScript è®¾è®¡æ¨¡å¼ä¸­ï¼Œä¸»è¦ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼åŸºæœ¬éƒ½å›´ç»• **å•ä¸€åŠŸèƒ½** å’Œ **å¼€æ”¾å°é—­** è¿™ä¸¤ä¸ªåŸåˆ™æ¥å±•å¼€ã€‚

è®¾è®¡æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯å°è£…å˜åŒ–ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸å‘ç”Ÿå˜åŒ–çš„ä»£ç å¯ä»¥è¯´æ˜¯ä¸å­˜åœ¨çš„ã€‚æˆ‘ä»¬èƒ½åšçš„åªæœ‰å°†è¿™ä¸ªå˜åŒ–é€ æˆçš„å½±å“æœ€å°åŒ– â€”â€” **å°†å˜ä¸ä¸å˜åˆ†ç¦»** ï¼Œç¡®ä¿å˜åŒ–çš„éƒ¨åˆ†çµæ´»ã€ä¸å˜çš„éƒ¨åˆ†ç¨³å®šã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±å« **å°è£…å˜åŒ–**ã€‚
s
åœ¨è¿™æœ¬ä¹¦ä¸­ï¼Œå°†23ç§è®¾è®¡æ¨¡å¼æŒ‰ç…§â€œåˆ›å»ºå‹â€ã€â€œè¡Œä¸ºå‹â€å’Œâ€œç»“æ„å‹â€è¿›è¡Œåˆ’åˆ†ï¼š
![all-design-patterns](~@assets/posts/javascript-design-patterns/all-design-patterns.png)
## åˆ›å»ºå‹
### å·¥å‚æ¨¡å¼ä¹‹ç®€å•å·¥å‚
ç®€å•å·¥å‚æ¨¡å¼çš„æ ¸å¿ƒå°±æ˜¯æŠ½ç¦»äº†å˜ä¸ä¸å˜ã€‚

å‡å¦‚æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼šä½¿ç”¨JSåˆ›å»ºä¸€ä¸ªPersonå¯¹è±¡ã€‚
```js
const liLei = {
    name: 'æé›·',
    age: 25,
    career: 'coder',
}
```
é‚£å¦‚æœåœºæ™¯å˜ä¸ºåˆ›å»ºå¤šä¸ªPersonå¯¹è±¡å‘¢ï¼Ÿæˆ‘ä»¬åº”è¯¥ä¸ä¼šé€‚åº”å¯¹è±¡å­—é¢é‡çš„æ–¹å¼æ¥è¿›è¡Œåˆ›å»ºå§ã€‚è¿™æ—¶æˆ‘ä»¬å°±ä¼šç”¨åˆ°**æ„é€ å‡½æ•°**ã€‚
```js
function User(name , age, career) {
  this.name = name;
  this.age = age;
  this.career = career;
}

const user = new User(name, age, career);
```
åƒ User è¿™æ ·å½“æ–°å»ºå¯¹è±¡çš„å†…å­˜è¢«åˆ†é…åï¼Œç”¨æ¥åˆå§‹åŒ–è¯¥å¯¹è±¡çš„ç‰¹æ®Šå‡½æ•°ï¼Œå°±å«åš**æ„é€ å™¨**ã€‚

åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°å»åˆå§‹åŒ–å¯¹è±¡ï¼Œå°±æ˜¯åº”ç”¨äº†**æ„é€ å™¨æ¨¡å¼**ã€‚

åœ¨åˆ›å»ºä¸€ä¸ªuserè¿‡ç¨‹ä¸­ï¼Œ**è°å˜äº†ï¼Œè°ä¸å˜**ï¼Ÿå¾ˆæ˜æ˜¾ï¼Œå˜çš„æ˜¯æ¯ä¸ªuserçš„å§“åã€å¹´é¾„ã€å·¥ç§è¿™äº›å€¼ï¼Œè¿™æ˜¯ç”¨æˆ·çš„ä¸ªæ€§ï¼Œä¸å˜çš„æ˜¯æ¯ä¸ªå‘˜å·¥éƒ½å…·å¤‡å§“åã€å¹´é¾„ã€å·¥ç§è¿™äº›å±æ€§ï¼Œè¿™æ˜¯ç”¨æˆ·çš„å…±æ€§ã€‚

ä½†æ˜¯å¦‚æœåœ¨è¿­ä»£çš„è¿‡ç¨‹ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼š**å¢åŠ ç»™ä¸åŒå·¥ç§åˆ†é…èŒè´£è¯´æ˜çš„åŠŸèƒ½**ã€‚é‚£è¿™æ ·å°±å¯¼è‡´å‘˜å·¥çš„å…±æ€§è¢«æ‹†ç¦»äº†ã€‚
```js
function Coder(name , age) {
  this.name = name;
  this.age = age;
  this.career = 'coder';
  this.work = ['å†™ä»£ç ','å†™ç³»åˆ†', 'ä¿®Bug'];
}
function ProductManager(name, age) {
  this.name = name;
  this.age = age;
  this.career = 'product manager';
  this.work = ['è®¢ä¼šè®®å®¤', 'å†™PRD', 'å‚¬æ›´'];
}
```
ä½†æ˜¯åœ¨æ ¹æœ¬ä¸Š Coder å’Œ ProductManager éƒ½å…·æœ‰nameï¼Œageï¼Œcareerï¼Œworkå±æ€§ï¼Œåªæ˜¯workå±æ€§éœ€è¦æ ¹æ®careerè‡ªåŠ¨çš„æ·»åŠ ã€‚

ç°åœ¨æˆ‘ä»¬æŠŠç›¸åŒçš„é€»è¾‘å°è£…å›Userç±»é‡Œï¼Œç„¶åæŠŠè¿™ä¸ªæ‰¿è½½äº†å…±æ€§çš„ User ç±»å’Œä¸ªæ€§åŒ–çš„é€»è¾‘åˆ¤æ–­å†™å…¥åŒä¸€ä¸ªå‡½æ•°ï¼š
```js
function User(name , age, career, work) {
  this.name = name;
  this.age = age;
  this.career = career;
  this.work = work;
}

function Factory(name, age, career) {
  let work;
  switch(career) {
    case 'coder':
      work =  ['å†™ä»£ç ','å†™ç³»åˆ†', 'ä¿®Bug'];
      break;
    case 'product manager':
      work = ['è®¢ä¼šè®®å®¤', 'å†™PRD', 'å‚¬æ›´'];
      break;
    case 'boss':
      work = ['å–èŒ¶', 'çœ‹æŠ¥', 'è§å®¢æˆ·'];
      break;
    //case 'xxx':
    //  å…¶å®ƒå·¥ç§çš„èŒè´£åˆ†é…
    //  ...
  }
  return new User(name, age, career, work)
}
```

ç°åœ¨æˆ‘ä»¬ä¸€èµ·æ¥æ€»ç»“ä¸€ä¸‹ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼ï¼š**å·¥å‚æ¨¡å¼å…¶å®å°±æ˜¯å°†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹å•ç‹¬å°è£…**ã€‚

æ€»ç»“ä¸€ä¸‹ï¼šå·¥å‚æ¨¡å¼çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºäº†å®ç°**æ— è„‘ä¼ å‚**ï¼Œå°±æ˜¯ä¸ºäº†çˆ½ï¼
### å·¥å‚æ¨¡å¼ä¹‹æŠ½è±¡å·¥å‚
æˆ‘ä»¬é‡æ–°çœ‹ç®€å•å·¥å‚çš„ä¾‹å­ï¼Œä¹ä¸€çœ‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ç»ä¸èµ·æ¨æ•²å‘€ã€‚é¦–å…ˆæ˜ å…¥çœ¼å¸˜çš„ Bugï¼Œæ˜¯æˆ‘ä»¬æŠŠ Boss è¿™ä¸ªè§’è‰²å’Œæ™®é€šå‘˜å·¥å¡è¿›äº†ä¸€ä¸ªå·¥å‚ã€‚

é¦–å…ˆ Boss çš„æƒé™å°±è·Ÿå’±ä»¬ä¸ä¸€æ ·ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰è®¸å¤šæ“ä½œï¼Œæ˜¯åªæœ‰ç®¡ç†å±‚å¯ä»¥æ‰§è¡Œçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹è¿™ä¸ªç¾¤ä½“çš„å¯¹è±¡è¿›è¡Œå•ç‹¬çš„é€»è¾‘å¤„ç†ã€‚

å»ä¿®æ”¹ Factory çš„å‡½æ•°ä½“ã€å¢åŠ ç®¡ç†å±‚ç›¸å…³çš„åˆ¤æ–­å’Œå¤„ç†é€»è¾‘å—ï¼Ÿå•ä»åŠŸèƒ½å®ç°ä¸Šæ¥è¯´ï¼Œæ²¡é—®é¢˜ã€‚ä½†æ˜¯è¿™ä¹ˆåšå°±æ˜¯åœ¨æŒ–å‘ã€‚

å› ä¸ºå…¬å¸ä¸ä»…ä»…åªæœ‰è¿™ä¸¤ç±»äººï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¤–åŒ…åŒå­¦ã€è¿˜æœ‰ä¿å®‰ï¼Œä»–ä»¬çš„æƒé™ã€èŒèƒ½éƒ½å­˜åœ¨ç€è´¨çš„å·®åˆ«ã€‚å¦‚æœå»¶ç»­è¿™ä¸ªæ€è·¯ï¼Œæ¯è€ƒè™‘åˆ°ä¸€ä¸ªæ–°çš„å‘˜å·¥ç¾¤ä½“ï¼Œå°±å›å»ä¿®æ”¹ä¸€æ¬¡ Factory çš„å‡½æ•°ä½“ï¼Œè¿™æ ·åšç³Ÿç³•é€äº†ï¼š
* é¦–å…ˆï¼Œ**æ˜¯ Factory ä¼šå˜å¾—å¼‚å¸¸åºå¤§**
* å…¶æ¬¡ï¼Œç”±äº Factory çš„åºå¤§ï¼Œå¯¼è‡´ Factory çš„é€»è¾‘**è¿‡äºç¹æ‚å’Œæ··ä¹±**ï¼Œæ²¡äººæ•¢ç»´æŠ¤å®ƒ
* æœ€åï¼Œæ¯æ¬¡æ–°åŠ ä¸€ä¸ªå·¥ç§ï¼Œéƒ½ä¸å¾—ä¸å¯¹æ•´ä¸ª Factory çš„é€»è¾‘**è¿›è¡Œå›å½’**

è¿™ä¸€åˆ‡æ‚²å‰§çš„æ ¹æºåªæœ‰ä¸€ä¸ªâ€”â€”æ²¡æœ‰éµå®ˆ**å¼€æ”¾å°é—­åŸåˆ™**ã€‚

å¼€æ”¾å°é—­åŸåˆ™çš„å†…å®¹æ˜¯ï¼šå¯¹æ‹“å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚è¯´å¾—æ›´å‡†ç¡®ç‚¹ï¼Œ**è½¯ä»¶å®ä½“ï¼ˆç±»ã€æ¨¡å—ã€å‡½æ•°ï¼‰å¯ä»¥æ‰©å±•ï¼Œä½†æ˜¯ä¸å¯ä¿®æ”¹**ã€‚

ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªæ‰‹æœºå·¥å‚çš„ä¾‹å­å±•ç¤ºä¸€ä¸‹ä»€ä¹ˆæ˜¯æŠ½è±¡å·¥å‚æ¨¡å¼ï¼š
```js
// æŠ½è±¡
class MobilePhoneFactory {
  // æä¾›æ“ä½œç³»ç»Ÿçš„æ¥å£
  createOS(){
    throw new Error("æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼");
  }
  // æä¾›ç¡¬ä»¶çš„æ¥å£
  createHardWare(){
    throw new Error("æŠ½è±¡å·¥å‚æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼");
  }
}
// å…·ä½“å·¥å‚ç»§æ‰¿è‡ªæŠ½è±¡å·¥å‚
class FakeStarFactory extends MobilePhoneFactory {
  createOS() {
    // æä¾›å®‰å“ç³»ç»Ÿå®ä¾‹
    return new AndroidOS()
  }
  createHardWare() {
    // æä¾›é«˜é€šç¡¬ä»¶å®ä¾‹
    return new QualcommHardWare()
  }
}
// å®šä¹‰æ“ä½œç³»ç»Ÿè¿™ç±»äº§å“çš„æŠ½è±¡äº§å“ç±»
class OS {
  controlHardWare() {
    throw new Error('æŠ½è±¡äº§å“æ–¹æ³•ä¸å…è®¸ç›´æ¥è°ƒç”¨ï¼Œä½ éœ€è¦å°†æˆ‘é‡å†™ï¼');
  }
}
// å®šä¹‰å…·ä½“æ“ä½œç³»ç»Ÿçš„å…·ä½“äº§å“ç±»
class AndroidOS extends OS {
  controlHardWare() {
    console.log('æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶')
  }
}
class AppleOS extends OS {
  controlHardWare() {
    console.log('æˆ‘ä¼šç”¨ğŸçš„æ–¹å¼å»æ“ä½œç¡¬ä»¶')
  }
}
```
å¥½äº†ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œå½“æˆ‘ä»¬éœ€è¦ç”Ÿäº§ä¸€å°FakeStaræ‰‹æœºæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·åšï¼š
```js
// è¿™æ˜¯æˆ‘çš„æ‰‹æœº
const myPhone = new FakeStarFactory()
// è®©å®ƒæ‹¥æœ‰æ“ä½œç³»ç»Ÿ
const myOS = myPhone.createOS()
// è®©å®ƒæ‹¥æœ‰ç¡¬ä»¶
const myHardWare = myPhone.createHardWare()
// å¯åŠ¨æ“ä½œç³»ç»Ÿ(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨å®‰å“çš„æ–¹å¼å»æ“ä½œç¡¬ä»¶â€™)
myOS.controlHardWare()
// å”¤é†’ç¡¬ä»¶(è¾“å‡ºâ€˜æˆ‘ä¼šç”¨é«˜é€šçš„æ–¹å¼å»è¿è½¬â€™)
myHardWare.operateByOrder()
```
å…³é”®çš„æ—¶åˆ»æ¥äº†â€”â€”å‡å¦‚æœ‰ä¸€å¤©ï¼Œ `FakeStar` è¿‡æ°”äº†ï¼Œæˆ‘ä»¬éœ€è¦äº§å‡ºä¸€æ¬¾æ–°æœºæŠ•å…¥å¸‚åœºï¼Œè¿™æ—¶å€™æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¸éœ€è¦å¯¹æŠ½è±¡å·¥å‚ `MobilePhoneFactory` åšä»»ä½•ä¿®æ”¹ï¼Œåªéœ€è¦æ‹“å±•å®ƒçš„ç§ç±»ï¼š
```js
class newStarFactory extends MobilePhoneFactory {
  createOS() {
    // æ“ä½œç³»ç»Ÿå®ç°ä»£ç 
  }
  createHardWare() {
    // ç¡¬ä»¶å®ç°ä»£ç 
  }
}
```
é‚£ä¹ˆæˆ‘ä»¬æ¥æ€è€ƒæŠ½è±¡å·¥å‚å’Œç®€å•å·¥å‚å®ƒä»¬ä¹‹é—´æœ‰å“ªäº›å¼‚åŒï¼Ÿ
* é¦–å…ˆç›¸åŒç‚¹æ˜¯ï¼šåœ¨äºéƒ½å°è¯•å»**åˆ†ç¦»ä¸€ä¸ªç³»ç»Ÿä¸­å˜ä¸ä¸å˜çš„éƒ¨åˆ†**ã€‚
* å…¶æ¬¡ä¸åŒç‚¹æ˜¯ï¼šå®ƒä»¬çš„ä¸åŒåœ¨äº**åœºæ™¯çš„å¤æ‚åº¦**ã€‚

åœ¨ç®€å•å·¥å‚çš„ä½¿ç”¨åœºæ™¯é‡Œï¼Œ**å¤„ç†çš„å¯¹è±¡æ˜¯ç±»**ï¼Œå¹¶ä¸”æ˜¯ä¸€äº›éå¸¸å¥½å¯¹ä»˜çš„ç±» â€”â€” å®ƒä»¬çš„**å…±æ€§å®¹æ˜“æŠ½ç¦»**ï¼ŒåŒæ—¶å› ä¸ºé€»è¾‘æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œæ•…è€Œä¸è‹›æ±‚ä»£ç å¯æ‰©å±•æ€§ã€‚

æŠ½è±¡å·¥å‚æœ¬è´¨ä¸Šå¤„ç†çš„å…¶å®ä¹Ÿæ˜¯ç±»ï¼Œä½†æ˜¯æ˜¯ä¸€å¸®**éå¸¸æ£˜æ‰‹ã€ç¹æ‚çš„ç±»**ï¼Œè¿™äº›ç±»ä¸­ä¸ä»…èƒ½åˆ’åˆ†å‡ºé—¨æ´¾ï¼Œè¿˜èƒ½åˆ’åˆ†å‡ºç­‰çº§ï¼ŒåŒæ—¶å­˜åœ¨ç€åƒå˜ä¸‡åŒ–çš„æ‰©å±•å¯èƒ½æ€§ â€”â€” è¿™ä½¿å¾—æˆ‘ä»¬å¿…é¡»**å¯¹å…±æ€§ä½œæ›´ç‰¹åˆ«çš„å¤„ç†ã€ä½¿ç”¨æŠ½è±¡ç±»å»é™ä½æ‰©å±•çš„æˆæœ¬**ï¼ŒåŒæ—¶éœ€è¦å¯¹ç±»çš„æ€§è´¨ä½œåˆ’åˆ†ï¼Œäºæ˜¯æœ‰äº†è¿™æ ·çš„å››ä¸ªå…³é”®è§’è‰²ï¼š
* **æŠ½è±¡å·¥å‚**ï¼šç”¨äºå£°æ˜æœ€ç»ˆç›®æ ‡äº§å“çš„å…±æ€§ã€‚
* **å…·ä½“å·¥å‚**ï¼šç»§æ‰¿è‡ªæŠ½è±¡å·¥å‚ã€å®ç°äº†æŠ½è±¡å·¥å‚é‡Œå£°æ˜çš„é‚£äº›æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå…·ä½“çš„äº§å“çš„ç±»ã€‚
* **æŠ½è±¡äº§å“**ï¼šå…·ä½“äº§å“ç±»çš„å…±æ€§å„è‡ªæŠ½ç¦»ï¼Œä¾¿å¯¹åº”åˆ°äº†å„è‡ªçš„æŠ½è±¡äº§å“ç±»ã€‚
* **å…·ä½“äº§å“**ï¼šæ¯”å¦‚æˆ‘ä»¬ä¸Šæ–‡ä¸­å…·ä½“çš„ä¸€ç§æ“ä½œç³»ç»Ÿã€æˆ–å…·ä½“çš„ä¸€ç§ç¡¬ä»¶ç­‰ã€‚
### å•ä¾‹æ¨¡å¼
**ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹**ï¼Œè¿™æ ·çš„æ¨¡å¼å°±å«åšå•ä¾‹æ¨¡å¼ã€‚

ç°åœ¨æˆ‘ä»¬å…ˆä¸è€ƒè™‘å•ä¾‹æ¨¡å¼çš„åº”ç”¨åœºæ™¯ï¼Œå•çœ‹å®ƒçš„å®ç°ï¼Œæ€è€ƒè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š**å¦‚ä½•æ‰èƒ½ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Ÿ**

è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦æ„é€ å‡½æ•°å…·å¤‡**åˆ¤æ–­è‡ªå·±æ˜¯å¦å·²ç»åˆ›å»ºè¿‡ä¸€ä¸ªå®ä¾‹çš„èƒ½åŠ›**ã€‚æˆ‘ä»¬ç°åœ¨æŠŠè¿™æ®µåˆ¤æ–­é€»è¾‘å†™æˆä¸€ä¸ª**é™æ€æ–¹æ³•(å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥å†™å…¥æ„é€ å‡½æ•°çš„å‡½æ•°ä½“é‡Œï¼‰**ï¼š
```js
class SingleDog {
    show() {
        console.log('æˆ‘æ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡')
    }
    static getInstance() {
        // åˆ¤æ–­æ˜¯å¦å·²ç»newè¿‡1ä¸ªå®ä¾‹
        if (!SingleDog.instance) {
            // è‹¥è¿™ä¸ªå”¯ä¸€çš„å®ä¾‹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆåˆ›å»ºå®ƒ
            SingleDog.instance = new SingleDog()
        }
        // å¦‚æœè¿™ä¸ªå”¯ä¸€çš„å®ä¾‹å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›
        return SingleDog.instance
    }
}

const s1 = SingleDog.getInstance()
const s2 = SingleDog.getInstance()

// true
s1 === s2
```
é™¤äº†æ¥¼ä¸Šè¿™ç§å®ç°æ–¹å¼ä¹‹å¤–ï¼Œ `getInstance` çš„é€»è¾‘è¿˜å¯ä»¥ç”¨**é—­åŒ…**æ¥å®ç°ï¼š
```js
SingleDog.getInstance = (function() {
    // å®šä¹‰è‡ªç”±å˜é‡instanceï¼Œæ¨¡æ‹Ÿç§æœ‰å˜é‡
    let instance = null
    return function() {
        // åˆ¤æ–­è‡ªç”±å˜é‡æ˜¯å¦ä¸ºnull
        if(!instance) {
            // å¦‚æœä¸ºnullåˆ™newå‡ºå”¯ä¸€å®ä¾‹
            instance = new SingleDog()
        }
        return instance
    }
})()
```
è¿‘å¹´æ¥ï¼ŒåŸºäº `Flux` æ¶æ„çš„çŠ¶æ€ç®¡ç†å·¥å…·å±‚å‡ºä¸ç©·ï¼Œå…¶ä¸­åº”ç”¨æœ€å¹¿æ³›çš„è¦æ•° `Redux` å’Œ `Vuex` ã€‚æ— è®ºæ˜¯ `Redux` å’Œ `Vuex` ï¼Œå®ƒä»¬éƒ½å®ç°äº†ä¸€ä¸ªå…¨å±€çš„ `Store` ç”¨äºå­˜å‚¨åº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ã€‚

è¿™ä¸ª `Store` çš„å®ç°ï¼Œæ­£æ˜¯å•ä¾‹æ¨¡å¼çš„å…¸å‹åº”ç”¨ã€‚
### åŸå‹æ¨¡å¼
åŸå‹æ¨¡å¼ä¸ä»…æ˜¯ä¸€ç§ **è®¾è®¡æ¨¡å¼** ï¼Œå®ƒè¿˜æ˜¯ä¸€ç§ **ç¼–ç¨‹èŒƒå¼ï¼ˆprogramming paradigmï¼‰** ï¼Œæ˜¯ `JavaScript` **é¢å‘å¯¹è±¡**ç³»ç»Ÿå®ç°çš„**æ ¹åŸº**ã€‚

åœ¨åŸå‹æ¨¡å¼ä¸‹ï¼Œå½“æˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šå…ˆæ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹ï¼Œç„¶åé€šè¿‡**å…‹éš†åŸå‹**çš„æ–¹å¼æ¥åˆ›å»ºå‡ºä¸€ä¸ªä¸åŸå‹ä¸€æ ·ï¼ˆå…±äº«ä¸€å¥—æ•°æ®/æ–¹æ³•ï¼‰çš„å¯¹è±¡ã€‚

åœ¨ `JavaScript` é‡Œï¼Œ `Object.create` æ–¹æ³•å°±æ˜¯åŸå‹æ¨¡å¼çš„å¤©ç„¶å®ç°ã€‚å‡†ç¡®åœ°è¯´ï¼Œåªè¦æˆ‘ä»¬è¿˜åœ¨å€ŸåŠ© `Prototype` æ¥å®ç°å¯¹è±¡çš„åˆ›å»ºå’ŒåŸå‹çš„ç»§æ‰¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ˜¯åœ¨åº”ç”¨åŸå‹æ¨¡å¼ã€‚

åŸå‹ç¼–ç¨‹èŒƒå¼çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯**åˆ©ç”¨å®ä¾‹æ¥æè¿°å¯¹è±¡ï¼Œç”¨å®ä¾‹ä½œä¸ºå®šä¹‰å¯¹è±¡å’Œç»§æ‰¿çš„åŸºç¡€**ã€‚åœ¨ JavaScript ä¸­ï¼ŒåŸå‹ç¼–ç¨‹èŒƒå¼çš„ä½“ç°å°±æ˜¯**åŸºäºåŸå‹é“¾çš„ç»§æ‰¿**ã€‚è¿™å…¶ä¸­ï¼Œå¯¹åŸå‹ã€åŸå‹é“¾çš„ç†è§£æ˜¯å…³é”®ã€‚

åœ¨ JavaScript ä¸­ï¼Œæ¯ä¸ª **æ„é€ å‡½æ•°** éƒ½æ‹¥æœ‰ä¸€ä¸ª `prototype` å±æ€§ï¼Œå®ƒæŒ‡å‘æ„é€ å‡½æ•°çš„ **åŸå‹å¯¹è±¡** ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª `constructor` å±æ€§æŒ‡å›æ„é€ å‡½æ•°ï¼›æ¯ä¸ªå®ä¾‹éƒ½æœ‰ä¸€ä¸ª `__proto__` å±æ€§ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨æ„é€ å‡½æ•°å»åˆ›å»ºå®ä¾‹æ—¶ï¼Œå®ä¾‹çš„ `__proto__` å±æ€§å°±ä¼šæŒ‡å‘æ„é€ å‡½æ•°çš„ **åŸå‹å¯¹è±¡** ã€‚ ä¾‹å¦‚ï¼š
```js
// åˆ›å»ºä¸€ä¸ªDogæ„é€ å‡½æ•°
function Dog(name, age) {
  this.name = name
  this.age = age
}
Dog.prototype.eat = function() {
  console.log('è‚‰éª¨å¤´çœŸå¥½åƒ')
}
// ä½¿ç”¨Dogæ„é€ å‡½æ•°åˆ›å»ºdogå®ä¾‹
const dog = new Dog('æ—ºè´¢', 3)
```
è¿™æ®µä»£ç é‡Œçš„å‡ ä¸ªå®ä½“ä¹‹é—´å°±å­˜åœ¨ç€è¿™æ ·çš„å…³ç³»ï¼š
![prototype](~@assets/posts/javascript-design-patterns/prototype.png)

ç°åœ¨æˆ‘åœ¨ä¸Šé¢é‚£æ®µä»£ç çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œä¸¤ä¸ªæ–¹æ³•è°ƒç”¨:
```js
// è¾“å‡º"è‚‰éª¨å¤´çœŸå¥½åƒ"
dog.eat()
// è¾“å‡º"[object Object]"
dog.toString()
```
æ˜æ˜æ²¡æœ‰åœ¨ `dog` å®ä¾‹é‡Œæ‰‹åŠ¨å®šä¹‰ `eat` æ–¹æ³•å’Œ `toString` æ–¹æ³•ï¼Œå®ƒä»¬è¿˜æ˜¯è¢«æˆåŠŸåœ°è°ƒç”¨äº†ã€‚

è¿™æ˜¯å› ä¸ºå½“æˆ‘è¯•å›¾è®¿é—®ä¸€ä¸ª `JavaScript` å®ä¾‹çš„å±æ€§/æ–¹æ³•æ—¶ï¼Œå®ƒé¦–å…ˆæœç´¢è¿™ä¸ª**å®ä¾‹æœ¬èº«**ï¼›å½“å‘ç°å®ä¾‹æ²¡æœ‰å®šä¹‰å¯¹åº”çš„å±æ€§/æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè½¬è€Œå»æœç´¢**å®ä¾‹çš„åŸå‹å¯¹è±¡**ï¼›å¦‚æœåŸå‹å¯¹è±¡ä¸­ä¹Ÿæœç´¢ä¸åˆ°ï¼Œå®ƒå°±å»æœç´¢**åŸå‹å¯¹è±¡çš„åŸå‹å¯¹è±¡**ï¼Œè¿™ä¸ªæœç´¢çš„è½¨è¿¹ï¼Œå°±å«åš**åŸå‹é“¾**ã€‚

![prototype-chain](~@assets/posts/javascript-design-patterns/prototype-chain.png)

ä¸Šå›¾è¿™äº›å½¼æ­¤ç›¸è¿çš„prototypeï¼Œå°±ç»„æˆäº†ä¸€ä¸ªåŸå‹é“¾ã€‚ 
## ç»“æ„å‹
### è£…é¥°å™¨æ¨¡å¼
è£…é¥°å™¨æ¨¡å¼ï¼Œåˆåè£…é¥°è€…æ¨¡å¼ã€‚å®ƒçš„å®šä¹‰æ˜¯â€œ**åœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¯¹å…¶è¿›è¡ŒåŒ…è£…æ‹“å±•ï¼Œä½¿åŸæœ‰å¯¹è±¡å¯ä»¥æ»¡è¶³ç”¨æˆ·çš„æ›´å¤æ‚éœ€æ±‚**â€ã€‚

åœ¨ ES7 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åƒå†™ python ä¸€æ ·é€šè¿‡ **@è¯­æ³•ç³–** è½»æ¾åœ°å®ç°è£…é¥°å™¨æ¨¡å¼ã€‚

#### Reactä¸­çš„è£…é¥°å™¨ï¼šHOC
> é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚

**HOC (Higher Order Component) å³é«˜é˜¶ç»„ä»¶**ã€‚å®ƒæ˜¯è£…é¥°å™¨æ¨¡å¼åœ¨ `React` ä¸­çš„å®è·µï¼ŒåŒæ—¶ä¹Ÿæ˜¯ `React` åº”ç”¨ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡ç¼–å†™é«˜é˜¶ç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å……åˆ†**å¤ç”¨ç°æœ‰é€»è¾‘ï¼Œæé«˜ç¼–ç æ•ˆç‡å’Œä»£ç çš„å¥å£®æ€§**ã€‚
### é€‚é…å™¨æ¨¡å¼
é€‚é…å™¨æ¨¡å¼é€šè¿‡**æŠŠä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£**ï¼Œå¯ä»¥å¸®æˆ‘ä»¬è§£å†³**ä¸å…¼å®¹**çš„é—®é¢˜ã€‚

å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦æˆ‘ä»¬å°†ä¹‹å‰é€šè¿‡ `XMLHttpRequest` å°è£…çš„è¯·æ±‚åº“è¿ç§»åˆ° `fetch API` ä¸Šï¼Œä¸¤ä¸ªçš„å®ç°åˆ†åˆ«å¦‚ä¸‹ï¼š
* fetchè¯·æ±‚å®ç°å¦‚ä¸‹
```js
export default class HttpUtils {
  // getæ–¹æ³•
  static get(url) {
    return new Promise((resolve, reject) => {
      // è°ƒç”¨fetch
      fetch(url)
        .then(response => response.json())
        .then(result => {
          resolve(result)
        })
        .catch(error => {
          reject(error)
        })
    })
  }
  
  // postæ–¹æ³•ï¼Œdataä»¥objectå½¢å¼ä¼ å…¥
  static post(url, data) {
    return new Promise((resolve, reject) => {
      // è°ƒç”¨fetch
      fetch(url, {
        method: 'POST',
        headers: {
          Accept: 'application/json',
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        // å°†objectç±»å‹çš„æ•°æ®æ ¼å¼åŒ–ä¸ºåˆæ³•çš„bodyå‚æ•°
        body: this.changeData(data)
      })
        .then(response => response.json())
        .then(result => {
          resolve(result)
        })
        .catch(error => {
          reject(error)
        })
    })
  }
  
  // bodyè¯·æ±‚ä½“çš„æ ¼å¼åŒ–æ–¹æ³•
  static changeData(obj) {
    var prop,
      str = ''
    var i = 0
    for (prop in obj) {
      if (!prop) {
        return
      }
      if (i === 0) {
        str += prop + '=' + obj[prop]
      } else {
        str += '&' + prop + '=' + obj[prop]
      }
      i++
    }
    return str
  }
}
```
* XMLHttpRequest å®ç°å¦‚ä¸‹ï¼š
```js
function Ajax(type, url, data, success, failed){
    // åˆ›å»ºajaxå¯¹è±¡
    var xhr = null;
    if(window.XMLHttpRequest){
        xhr = new XMLHttpRequest();
    } else {
        xhr = new ActiveXObject('Microsoft.XMLHTTP')
    }
 
   // ...(æ­¤å¤„çœç•¥ä¸€ç³»åˆ—çš„ä¸šåŠ¡é€»è¾‘ç»†èŠ‚)
   
   var type = type.toUpperCase();
    
    // è¯†åˆ«è¯·æ±‚ç±»å‹
    if(type === 'GET'){
        if(data){
          xhr.open('GET', url + '?' + data, true); //å¦‚æœæœ‰æ•°æ®å°±æ‹¼æ¥
        } 
        // å‘é€getè¯·æ±‚
        xhr.send();
 
    } else if(type === 'POST'){
        xhr.open('POST', url, true);
        // å¦‚æœéœ€è¦åƒ html è¡¨å•é‚£æ · POST æ•°æ®ï¼Œä½¿ç”¨ setRequestHeader() æ¥æ·»åŠ  http å¤´ã€‚
        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        // å‘é€postè¯·æ±‚
        xhr.send(data);
    }
 
    // å¤„ç†è¿”å›æ•°æ®
    xhr.onreadystatechange = function(){
        if(xhr.readyState === 4){
            if(xhr.status === 200){
                success(xhr.responseText);
            } else {
                if(failed){
                    failed(xhr.status);
                }
            }
        }
    }
}
```
è¿™æ˜¯æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä¸“é—¨ä¸ºæˆ‘ä»¬æŠ¹å¹³å·®å¼‚çš„é€‚é…å™¨æ¨¡å¼ã€‚
```js
// Ajaxé€‚é…å™¨å‡½æ•°ï¼Œå…¥å‚ä¸æ—§æ¥å£ä¿æŒä¸€è‡´
async function AjaxAdapter(type, url, data, success, failed) {
    const type = type.toUpperCase()
    let result
    try {
         // å®é™…çš„è¯·æ±‚å…¨éƒ¨ç”±æ–°æ¥å£å‘èµ·
         if(type === 'GET') {
            result = await HttpUtils.get(url) || {}
        } else if(type === 'POST') {
            result = await HttpUtils.post(url, data) || {}
        }
        // å‡è®¾è¯·æ±‚æˆåŠŸå¯¹åº”çš„çŠ¶æ€ç æ˜¯1
        result.statusCode === 1 && success ? success(result) : failed(result.statusCode)
    } catch(error) {
        // æ•æ‰ç½‘ç»œé”™è¯¯
        if(failed){
            failed(error.statusCode);
        }
    }
}

// ç”¨é€‚é…å™¨é€‚é…æ—§çš„Ajaxæ–¹æ³•
async function Ajax(type, url, data, success, failed) {
    await AjaxAdapter(type, url, data, success, failed)
}
```
å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦ç¼–å†™ä¸€ä¸ªé€‚é…å™¨å‡½æ•° `AjaxAdapter` ï¼Œå¹¶ç”¨é€‚é…å™¨å»æ‰¿æ¥æ—§æ¥å£çš„å‚æ•°ï¼Œå°±å¯ä»¥å®ç°æ–°æ—§æ¥å£çš„æ— ç¼è¡”æ¥äº†ã€‚

#### axiosä¸­çš„é€‚é…å™¨
åœ¨ `axios` çš„æ ¸å¿ƒé€»è¾‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°å®é™…ä¸Šæ´¾å‘è¯·æ±‚çš„æ˜¯ `dispatchRequest` æ–¹æ³•ã€‚è¯¥æ–¹æ³•å†…éƒ¨å…¶å®ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š
* æ•°æ®è½¬æ¢ï¼Œè½¬æ¢è¯·æ±‚ä½“/å“åº”ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®å±‚é¢çš„é€‚é…
* è°ƒç”¨é€‚é…å™¨

è°ƒç”¨é€‚é…å™¨çš„é€»è¾‘å¦‚ä¸‹ï¼š
```js
// è‹¥ç”¨æˆ·æœªæ‰‹åŠ¨é…ç½®é€‚é…å™¨ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„é€‚é…å™¨
var adapter = config.adapter || defaults.adapter;
  
  // dispatchRequestæ–¹æ³•çš„æœ«å°¾è°ƒç”¨çš„æ˜¯é€‚é…å™¨æ–¹æ³•
  return adapter(config).then(function onAdapterResolution(response) {
    // è¯·æ±‚æˆåŠŸçš„å›è°ƒ
    throwIfCancellationRequested(config);

    // è½¬æ¢å“åº”ä½“
    response.data = transformData(
      response.data,
      response.headers,
      config.transformResponse
    );

    return response;
  }, function onAdapterRejection(reason) {
    // è¯·æ±‚å¤±è´¥çš„å›è°ƒ
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      // è½¬æ¢å“åº”ä½“
      if (reason && reason.response) {
        reason.response.data = transformData(
          reason.response.data,
          reason.response.headers,
          config.transformResponse
        );
      }
    }

    return Promise.reject(reason);
  });
```
å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `é»˜è®¤é€‚é…å™¨` çš„é¢‘ç‡æ›´é«˜ã€‚é»˜è®¤é€‚é…å™¨åœ¨ `axios/lib/default.js` é‡Œæ˜¯é€šè¿‡ `getDefaultAdapter` æ–¹æ³•æ¥è·å–çš„ï¼š
```js
function getDefaultAdapter() {
  var adapter;
  // åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯nodeç¯å¢ƒ
  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {
    // å¦‚æœæ˜¯nodeç¯å¢ƒï¼Œè°ƒç”¨nodeä¸“å±çš„httpé€‚é…å™¨
    adapter = require('./adapters/http');
  } else if (typeof XMLHttpRequest !== 'undefined') {
    // å¦‚æœæ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œè°ƒç”¨åŸºäºxhrçš„é€‚é…å™¨
    adapter = require('./adapters/xhr');
  }
  return adapter;
}
```
è¿™ä¹ˆä¸€æ¥ï¼Œé€šè¿‡ `axios` å‘èµ·è·¨å¹³å°çš„ç½‘ç»œè¯·æ±‚ï¼Œä¸ä»…è°ƒç”¨çš„ **æ¥å£å** æ˜¯åŒä¸€ä¸ªï¼Œè¿ **å…¥å‚** ã€ **å‡ºå‚** çš„æ ¼å¼éƒ½åªéœ€è¦æŒæ¡åŒä¸€å¥—ã€‚
### ä»£ç†æ¨¡å¼
åœ¨ `ES6` ä¸­ï¼Œæä¾›äº†ä¸“é—¨ä»¥ä»£ç†è§’è‰²å‡ºç°çš„ä»£ç†å™¨ â€”â€” `Proxy` ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š
```js
const proxy = new Proxy(obj, handlers);
```
**ä»£ç†æ¨¡å¼**åœ¨å‰ç«¯é¢†åŸŸä¸€ç›´æ˜¯ä¸€ç§åº”ç”¨ååˆ†å¹¿æ³›çš„è®¾è®¡æ¨¡å¼ï¼Œä¸‹é¢æˆ‘ä»¬å¯¹å¼€å‘ä¸­æœ€å¸¸è§çš„å››ç§ä»£ç†ç±»å‹ï¼š**äº‹ä»¶ä»£ç†**ã€**è™šæ‹Ÿä»£ç†**ã€**ç¼“å­˜ä»£ç†**å’Œ**ä¿æŠ¤ä»£ç†**æ¥è¿›è¡Œè®²è§£ã€‚

**1ã€äº‹ä»¶ä»£ç†**

äº‹ä»¶ä»£ç†ï¼Œå¯èƒ½æ˜¯ä»£ç†æ¨¡å¼æœ€å¸¸è§çš„ä¸€ç§åº”ç”¨æ–¹å¼ã€‚é€šè¿‡åˆ©ç”¨äº‹ä»¶æœ¬èº«å…·æœ‰â€œå†’æ³¡â€çš„ç‰¹æ€§ï¼Œç‚¹å‡»äº‹ä»¶çš„ç›‘å¬å‡½æ•°åªéœ€è¦åœ¨çˆ¶å…ƒç´ ä¸Šè¢«ç»‘å®šä¸€æ¬¡å³å¯ï¼Œè€Œä¸éœ€è¦åœ¨å­å…ƒç´ ä¸Šè¢«ç»‘å®š N æ¬¡ã€‚

è¿™ç§åšæ³•å°±æ˜¯äº‹ä»¶ä»£ç†ï¼Œå®ƒå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æˆ‘ä»¬ä»£ç çš„æ€§èƒ½ã€‚

**2ã€è™šæ‹Ÿä»£ç†**

è¿™é‡Œå‚ç…§çš„æ˜¯ **å›¾ç‰‡é¢„åŠ è½½** çš„åœºæ™¯ï¼š
```js
class PreLoadImage {
    constructor(imgNode) {
      // è·å–çœŸå®çš„DOMèŠ‚ç‚¹
      this.imgNode = imgNode
    }
    // æ“ä½œimgèŠ‚ç‚¹çš„srcå±æ€§
    setSrc(imgUrl) {
      this.imgNode.src = imgUrl
    }
}

class ProxyImage {
    // å ä½å›¾çš„urlåœ°å€
    static LOADING_URL = 'xxxxxx'
    constructor(targetImage) {
      // ç›®æ ‡Imageï¼Œå³PreLoadImageå®ä¾‹
      this.targetImage = targetImage
    }
    // è¯¥æ–¹æ³•ä¸»è¦æ“ä½œè™šæ‹ŸImageï¼Œå®ŒæˆåŠ è½½
    setSrc(targetUrl) {
      // çœŸå®imgèŠ‚ç‚¹åˆå§‹åŒ–æ—¶å±•ç¤ºçš„æ˜¯ä¸€ä¸ªå ä½å›¾
      this.targetImage.setSrc(ProxyImage.LOADING_URL)
      // åˆ›å»ºä¸€ä¸ªå¸®æˆ‘ä»¬åŠ è½½å›¾ç‰‡çš„è™šæ‹ŸImageå®ä¾‹
      const virtualImage = new Image()
      // ç›‘å¬ç›®æ ‡å›¾ç‰‡åŠ è½½çš„æƒ…å†µï¼Œå®Œæˆæ—¶å†å°†DOMä¸Šçš„çœŸå®imgèŠ‚ç‚¹çš„srcå±æ€§è®¾ç½®ä¸ºç›®æ ‡å›¾ç‰‡çš„url
      virtualImage.onload = () => {
          this.targetImage.setSrc(targetUrl)
      }
      // è®¾ç½®srcå±æ€§ï¼Œè™šæ‹ŸImageå®ä¾‹å¼€å§‹åŠ è½½å›¾ç‰‡
      virtualImage.src = targetUrl
    }
}
```
`ProxyImage` å¸®æˆ‘ä»¬è°ƒåº¦äº†é¢„åŠ è½½ç›¸å…³çš„å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `ProxyImage` è¿™ä¸ªä»£ç†ï¼Œå®ç°å¯¹çœŸå® `img` èŠ‚ç‚¹çš„é—´æ¥è®¿é—®ï¼Œå¹¶å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚

åœ¨è¿™ä¸ªå®ä¾‹ä¸­ï¼Œ `virtualImage` è¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªâ€œå¹•åè‹±é›„â€ï¼Œå®ƒå§‹ç»ˆå­˜åœ¨äº `JavaScript` ä¸–ç•Œä¸­ã€ä»£æ›¿ `çœŸå® DOM` å‘èµ·äº†å›¾ç‰‡åŠ è½½è¯·æ±‚ã€å®Œæˆäº†å›¾ç‰‡åŠ è½½å·¥ä½œï¼Œå´ä»æœªåœ¨æ¸²æŸ“å±‚é¢æŠ›å¤´éœ²é¢ã€‚

å› æ­¤è¿™ç§æ¨¡å¼è¢«ç§°ä¸ºâ€œè™šæ‹Ÿä»£ç†â€æ¨¡å¼ã€‚

**3ã€ç¼“å­˜ä»£ç†**

ç¼“å­˜ä»£ç†æ¯”è¾ƒå¥½ç†è§£ï¼Œå®ƒåº”ç”¨äºä¸€äº›**è®¡ç®—é‡è¾ƒå¤§**çš„åœºæ™¯é‡Œã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦â€œ**ç”¨ç©ºé—´æ¢æ—¶é—´**â€çš„æ€æƒ³ã€‚

å½“æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŸä¸ªå·²ç»è®¡ç®—è¿‡çš„å€¼çš„æ—¶å€™ï¼Œä¸æƒ³å†è€—æ—¶è¿›è¡ŒäºŒæ¬¡è®¡ç®—ï¼Œè€Œæ˜¯å¸Œæœ›èƒ½ä»å†…å­˜é‡Œå»å–å‡ºç°æˆçš„è®¡ç®—ç»“æœã€‚

**4ã€ä¿æŠ¤ä»£ç†**

æ‰€è°“â€œä¿æŠ¤ä»£ç†â€ï¼Œå°±æ˜¯åœ¨**è®¿é—®å±‚é¢**åšæ–‡ç« ï¼Œåœ¨ `getter` å’Œ `setter` å‡½æ•°é‡Œå»è¿›è¡Œæ ¡éªŒå’Œæ‹¦æˆªï¼Œç¡®ä¿ä¸€éƒ¨åˆ†å˜é‡æ˜¯å®‰å…¨çš„ã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°çš„ `Proxy` ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸ºæ‹¦æˆªè€Œç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›®å‰å®ç°ä¿æŠ¤ä»£ç†æ—¶ï¼Œè€ƒè™‘çš„é¦–è¦æ–¹æ¡ˆå°±æ˜¯ `ES6` ä¸­çš„ `Proxy` ã€‚
## è¡Œä¸ºå‹
### ç­–ç•¥æ¨¡å¼
ç­–ç•¥æ¨¡å¼çš„å®šä¹‰å¦‚ä¸‹ï¼š
> å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•,æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥, å¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚

ä¾‹å¦‚æœ‰å¦‚ä¸‹ä¸€ä¸ªåœºæ™¯ï¼Œå°±æ˜¯è¯´åŒä¸€ä¸ªå•†å“ï¼Œæˆ‘é€šè¿‡åœ¨åå°ç»™å®ƒè®¾ç½®ä¸åŒçš„ä»·æ ¼ç±»å‹ï¼Œå¯ä»¥è®©å®ƒå±•ç¤ºä¸åŒçš„ä»·æ ¼ã€‚å…·ä½“çš„é€»è¾‘å¦‚ä¸‹ï¼š
* å½“ä»·æ ¼ç±»å‹ä¸ºâ€œé¢„å”®ä»·â€æ—¶ï¼Œæ»¡ 100 - 20ï¼Œä¸æ»¡ 100 æ‰“ 9 æŠ˜
* å½“ä»·æ ¼ç±»å‹ä¸ºâ€œå¤§ä¿ƒä»·â€æ—¶ï¼Œæ»¡ 100 - 30ï¼Œä¸æ»¡ 100 æ‰“ 8 æŠ˜
* å½“ä»·æ ¼ç±»å‹ä¸ºâ€œè¿”åœºä»·â€æ—¶ï¼Œæ»¡ 200 - 50ï¼Œä¸å åŠ 
* å½“ä»·æ ¼ç±»å‹ä¸ºâ€œå°é²œä»·â€æ—¶ï¼Œç›´æ¥æ‰“ 5 æŠ˜

æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„åˆ™æ˜¯é€šè¿‡ `if-else` æ¥åˆ¤æ–­ï¼š
```js
// è¯¢ä»·æ–¹æ³•ï¼Œæ¥å—ä»·æ ¼æ ‡ç­¾å’ŒåŸä»·ä¸ºå…¥å‚
function askPrice(tag, originPrice) {
  // å¤„ç†é¢„çƒ­ä»·
  if(tag === 'pre') {
    if(originPrice >= 100) {
      return originPrice - 20
    } 
    return originPrice * 0.9
  }
  // å¤„ç†å¤§ä¿ƒä»·
  if(tag === 'onSale') {
    if(originPrice >= 100) {
      return originPrice - 30
    } 
    return originPrice * 0.8
  }
  // å¤„ç†è¿”åœºä»·
  if(tag === 'back') {
    if(originPrice >= 200) {
      return originPrice - 50
    }
    return originPrice
  }
  // å¤„ç†å°é²œä»·
  if(tag === 'fresh') {
     return originPrice * 0.5
  }
}
```
ä½†æ˜¯å¦‚ä¸Šçš„ä»£ç è¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™å’Œå¼€æ”¾å°é—­åŸåˆ™ï¼Œé‚£ä¹ˆå¯¹äºè¿™æ®µä»£ç çš„æ”¹é€ ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æŠ½ç¦»è¯¢ä»·é€»è¾‘ï¼Œå®ç°å•ä¸€åŠŸèƒ½ã€‚

ç„¶åæˆ‘ä»¬éœ€è¦è¿›è¡Œå¼€æ”¾å°é—­æ”¹é€ ï¼Œæˆ‘ä»¬å¯¹äº **è¯¢ä»·æ ‡ç­¾-è¯¢ä»·å‡½æ•°** çš„æ˜ å°„å…³ç³»è¦é¿å…ä½¿ç”¨ `if-else`, æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è±¡å±æ€§æ˜ å°„çš„æ–¹å¼æ¥å»å¤„ç†ï¼š
```js
// å®šä¹‰ä¸€ä¸ªè¯¢ä»·å¤„ç†å™¨å¯¹è±¡
const priceProcessor = {
  pre(originPrice) {
    if (originPrice >= 100) {
      return originPrice - 20;
    }
    return originPrice * 0.9;
  },
  onSale(originPrice) {
    if (originPrice >= 100) {
      return originPrice - 30;
    }
    return originPrice * 0.8;
  },
  back(originPrice) {
    if (originPrice >= 200) {
      return originPrice - 50;
    }
    return originPrice;
  },
  fresh(originPrice) {
    return originPrice * 0.5;
  },
};

// è¯¢ä»·å‡½æ•°
function askPrice(tag, originPrice) {
  return priceProcessor[tag](originPrice)
}
```
è¿™æ ·å¢åŠ æ–°çš„è¯¢ä»·è§„åˆ™æ—¶ï¼Œåªéœ€è¦åœ¨ `priceProcessor` å¯¹è±¡ä¸­å»æ·»åŠ ç›¸åº”è§„åˆ™å³å¯ã€‚
### çŠ¶æ€æ¨¡å¼
çŠ¶æ€æ¨¡å¼å®šä¹‰å¦‚ä¸‹ï¼š
> å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚

çŠ¶æ€æ¨¡å¼ä¸»è¦è§£å†³çš„é—®é¢˜å¦‚ä¸‹ï¼š
> çŠ¶æ€æ¨¡å¼ä¸»è¦è§£å†³çš„æ˜¯å½“æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çŠ¶æ€çš„æ¡ä»¶è¡¨è¾¾å¼è¿‡äºå¤æ‚æ—¶çš„æƒ…å†µã€‚æŠŠçŠ¶æ€çš„åˆ¤æ–­é€»è¾‘è½¬ç§»åˆ°è¡¨ç¤ºä¸åŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç±»ä¸­ï¼Œå¯ä»¥æŠŠå¤æ‚çš„åˆ¤æ–­é€»è¾‘ç®€åŒ–ã€‚

å…³äºçŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„åŒºåˆ«ï¼Œå¤§å®¶çŸ¥é“ï¼Œç­–ç•¥æ¨¡å¼æ˜¯å¯¹ç®—æ³•çš„å°è£…ã€‚ç®—æ³•å’ŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºå‡½æ•°è™½ç„¶æœ¬è´¨ä¸Šéƒ½æ˜¯è¡Œä¸ºï¼Œä½†æ˜¯ç®—æ³•çš„ç‹¬ç«‹æ€§å¯é«˜å¤šäº†ã€‚

ç­–ç•¥æ¨¡å¼å’ŒçŠ¶æ€æ¨¡å¼ç¡®å®æ˜¯ç›¸ä¼¼çš„ï¼Œå®ƒä»¬éƒ½å°è£…è¡Œä¸ºã€éƒ½é€šè¿‡å§”æ‰˜æ¥å®ç°è¡Œä¸ºåˆ†å‘ã€‚

ä½†ç­–ç•¥æ¨¡å¼ä¸­çš„è¡Œä¸ºå‡½æ•°æ˜¯â€æ½‡æ´’â€œçš„è¡Œä¸ºå‡½æ•°ï¼Œå®ƒä»¬ä¸ä¾èµ–è°ƒç”¨ä¸»ä½“ã€äº’ç›¸å¹³è¡Œã€å„è‡ªä¸ºæ”¿ï¼Œäº•æ°´ä¸çŠ¯æ²³æ°´ã€‚

è€ŒçŠ¶æ€æ¨¡å¼ä¸­çš„è¡Œä¸ºå‡½æ•°ï¼Œé¦–å…ˆæ˜¯å’ŒçŠ¶æ€ä¸»ä½“ä¹‹é—´å­˜åœ¨ç€å…³è”ï¼Œç”±çŠ¶æ€ä¸»ä½“æŠŠå®ƒä»¬ä¸²åœ¨ä¸€èµ·ï¼›å¦ä¸€æ–¹é¢ï¼Œæ­£å› ä¸ºå…³è”ç€åŒæ ·çš„ä¸€ä¸ªï¼ˆæˆ–ä¸€ç±»ï¼‰ä¸»ä½“ï¼Œæ‰€ä»¥ä¸åŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºå‡½æ•°å¯èƒ½å¹¶ä¸ä¼šç‰¹åˆ«å‰²è£‚ã€‚
### è§‚å¯Ÿè€…æ¨¡å¼
> è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå½“è¿™ä¸ªç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ã€‚

è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ˜¯æ‰€æœ‰ JavaScript è®¾è®¡æ¨¡å¼ä¸­**ä½¿ç”¨é¢‘ç‡æœ€é«˜**ï¼Œ**é¢è¯•é¢‘ç‡ä¹Ÿæœ€é«˜**çš„è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥è¯´å®ƒååˆ†é‡è¦ã€‚

è§‚å¯Ÿè€…æ¨¡å¼ä¸­æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„è§’è‰²è¦ç´ ï¼šå‘å¸ƒè€…å’Œè®¢é˜…è€…ã€‚

è®¢é˜…è€…å…³æ³¨ç›®æ ‡å¯¹è±¡ï¼Œè€Œç›®æ ‡å¯¹è±¡çš„åˆ™æ˜¯ç”±å‘å¸ƒè€…ä¿®æ”¹å¹¶åœ¨ä¿®æ”¹åé€šçŸ¥è®¢é˜…è€…ï¼š**è§’è‰²åˆ’åˆ† --> çŠ¶æ€å˜åŒ– --> å‘å¸ƒè€…é€šçŸ¥åˆ°è®¢é˜…è€…**ï¼Œè¿™å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„â€œå¥—è·¯â€ã€‚

è¿™é‡Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª `EventEmitter` ï¼Œ `EventEmitter` æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼çš„å…¸å‹å®ç°ã€‚

ä¸€ä¸ª `EventEmitter` ä¸»è¦åŒ…å« `on` ï¼Œ `off` ï¼Œ `once` , `emit` æ–¹æ³•ã€‚
```js
class EventEmitter {
  constructor() {
    // handlersæ˜¯ä¸€ä¸ªmapï¼Œç”¨äºå­˜å‚¨äº‹ä»¶ä¸å›è°ƒä¹‹é—´çš„å¯¹åº”å…³ç³»
    this.handlers = {}
  }
  // onæ–¹æ³•ç”¨äºå®‰è£…äº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒæ¥å—ç›®æ ‡äº‹ä»¶åå’Œå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°
  on(eventName, cb) {
    // å…ˆæ£€æŸ¥ä¸€ä¸‹ç›®æ ‡äº‹ä»¶åæœ‰æ²¡æœ‰å¯¹åº”çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—
    if (!this.handlers[eventName]) {
      // å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆé¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªç›‘å¬å‡½æ•°é˜Ÿåˆ—
      this.handlers[eventName] = []
    }

    // æŠŠå›è°ƒå‡½æ•°æ¨å…¥ç›®æ ‡äº‹ä»¶çš„ç›‘å¬å‡½æ•°é˜Ÿåˆ—é‡Œå»
    this.handlers[eventName].push(cb)
  }
  // emitæ–¹æ³•ç”¨äºè§¦å‘ç›®æ ‡äº‹ä»¶ï¼Œå®ƒæ¥å—äº‹ä»¶åå’Œç›‘å¬å‡½æ•°å…¥å‚ä½œä¸ºå‚æ•°
  emit(eventName, ...args) {
    // æ£€æŸ¥ç›®æ ‡äº‹ä»¶æ˜¯å¦æœ‰ç›‘å¬å‡½æ•°é˜Ÿåˆ—
    if (this.handlers[eventName]) {
      // å¦‚æœæœ‰ï¼Œåˆ™é€ä¸ªè°ƒç”¨é˜Ÿåˆ—é‡Œçš„å›è°ƒå‡½æ•°
      this.handlers[eventName].forEach((callback) => {
        callback(...args)
      })
    }
  }
  // ç§»é™¤æŸä¸ªäº‹ä»¶å›è°ƒé˜Ÿåˆ—é‡Œçš„æŒ‡å®šå›è°ƒå‡½æ•°
  off(eventName, cb) {
    const callbacks = this.handlers[eventName]
    const index = callbacks.indexOf(cb)
    if (index !== -1) {
      callbacks.splice(index, 1)
    }
  }
  // ä¸ºäº‹ä»¶æ³¨å†Œå•æ¬¡ç›‘å¬å™¨
  once(eventName, cb) {
    // å¯¹å›è°ƒå‡½æ•°è¿›è¡ŒåŒ…è£…ï¼Œä½¿å…¶æ‰§è¡Œå®Œæ¯•è‡ªåŠ¨è¢«ç§»é™¤
    const wrapper = (...args) => {
      cb(...args)
      this.off(eventName, wrapper)
    }
    this.on(eventName, wrapper)
  }
}
```
### è¿­ä»£å™¨æ¨¡å¼
> è¿­ä»£å™¨æ¨¡å¼æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ â€”â€”ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹

è¿­ä»£å™¨æ¨¡å¼æ˜¯è®¾è®¡æ¨¡å¼ä¸­å°‘æœ‰çš„**ç›®çš„æ€§æå¼º**çš„æ¨¡å¼ã€‚æ‰€è°“â€œç›®çš„æ€§æå¼ºâ€å°±æ˜¯è¯´å®ƒä¸æ“å¿ƒåˆ«çš„ï¼Œå®ƒå°±è§£å†³è¿™ä¸€ä¸ªé—®é¢˜ â€”â€” **éå†** ã€‚

`ES6` åœ¨æ¨å‡ºæ–°æ•°æ®ç»“æ„ `Map`ã€`Set` çš„åŒæ—¶ä¹Ÿæ¨å‡ºäº†ä¸€å¥—ç»Ÿä¸€çš„æ¥å£æœºåˆ¶ â€”â€” **è¿­ä»£å™¨**ï¼ˆ `Iterator` ï¼‰ã€‚

`ES6` çº¦å®šï¼Œä»»ä½•æ•°æ®ç»“æ„åªè¦å…·å¤‡ `Symbol.iterator` å±æ€§ï¼ˆè¿™ä¸ªå±æ€§å°±æ˜¯ `Iterator` çš„å…·ä½“å®ç°ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å½“å‰æ•°æ®ç»“æ„é»˜è®¤çš„**è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°**ï¼‰ï¼Œå°±å¯ä»¥è¢«éå†ã€‚

å‡†ç¡®åœ°è¯´ï¼Œæ˜¯è¢«`for...of...`å¾ªç¯å’Œè¿­ä»£å™¨çš„`next`æ–¹æ³•éå†ã€‚ äº‹å®ä¸Šï¼Œ`for...of...`çš„èƒŒåæ­£æ˜¯å¯¹`next`æ–¹æ³•çš„åå¤è°ƒç”¨ã€‚

åœ¨ES6ä¸­ï¼Œå®ç°ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°å¹¶ä¸æ˜¯ä»€ä¹ˆéš¾äº‹å„¿ï¼Œå› ä¸ºES6æ—©å¸®æˆ‘ä»¬è€ƒè™‘å¥½äº†å…¨å¥—çš„è§£å†³æ–¹æ¡ˆï¼Œå†…ç½®äº†è´´å¿ƒçš„ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼š
```js
// ç¼–å†™ä¸€ä¸ªè¿­ä»£å™¨ç”Ÿæˆå‡½æ•°
function *iteratorGenerator() {
  yield '1å·é€‰æ‰‹'
  yield '2å·é€‰æ‰‹'
  yield '3å·é€‰æ‰‹'
}

const iterator = iteratorGenerator()

iterator.next()
iterator.next()
iterator.next()
```
ä¸‹é¢æˆ‘ä»¬è¦åšçš„ï¼Œä¸ä»…ä»…æ˜¯å†™ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œè€Œæ˜¯ç”¨ `ES5` å»å†™ä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆè¿­ä»£å™¨å¯¹è±¡çš„è¿­ä»£å™¨ç”Ÿæˆå‡½æ•°ï¼ˆè§£æåœ¨æ³¨é‡Šé‡Œï¼‰ï¼š
```js
// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¥å‚æ˜¯ä»»æ„é›†åˆ
function iteratorGenerator(list) {
  // idxè®°å½•å½“å‰è®¿é—®çš„ç´¢å¼•
  var idx = 0
  // lenè®°å½•ä¼ å…¥é›†åˆçš„é•¿åº¦
  var len = list.length
  return {
    // è‡ªå®šä¹‰nextæ–¹æ³•
    next: function() {
      // å¦‚æœç´¢å¼•è¿˜æ²¡æœ‰è¶…å‡ºé›†åˆé•¿åº¦ï¼Œdoneä¸ºfalse
      var done = idx >= len
      // å¦‚æœdoneä¸ºfalseï¼Œåˆ™å¯ä»¥ç»§ç»­å–å€¼
      var value = !done ? list[idx++] : undefined
      
      // å°†å½“å‰å€¼ä¸éå†æ˜¯å¦å®Œæ¯•ï¼ˆdoneï¼‰è¿”å›
      return {
        done: done,
        value: value
      }
    }
  }
}

var iterator = iteratorGenerator(['1å·é€‰æ‰‹', '2å·é€‰æ‰‹', '3å·é€‰æ‰‹'])
iterator.next()
iterator.next()
iterator.next()
```